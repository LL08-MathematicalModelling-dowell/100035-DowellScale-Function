<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>NPS LITE SCALE</title>
    <style>
    *{
        margin: 0;
        padding: 0;
    }

    .main-container_nps_lite{
        display: flex;
        flex-direction : column;
        justify-content: center;
        padding: 30px;
        border-radius: 15px;
        width: 400px;
        margin-top: 5%;
        border: 1px solid darkgreen;
        position: relative;
    }

    .time_nps_lite{
        color: blue;
        font-style: italic;
        font-weight: bold;
        position:absolute;
        top: 0;
        right: 0;
        margin:10px;
        font-size: 14px

    }

    .title_nps_lite{
     display: flex;
     justify-content: center;
     text-align: center;
     padding-top: 10px;
     color: gray;
     font-weight: bold;
    }

    .container_nps_lite{
    display: flex;
    justify-content: space-between;
    padding: 15px 0px 0px 0px;
    }

    .container_nps_lite div{
    background: #6df782;
    color: green;
    font-weight: bold;
    padding: 5px 20px;
    border-radius: 25px;
    cursor: pointer;
    margin: 5px;
    text-align: center;
    }

    .container_nps_lite div:hover{
    background: #2edb4e;
    }
    </style>
</head>
<form method="POST" id="jsform">
    {% csrf_token %}
    <input type="hidden" name="scoretag" id="scoretag" >
</form>

<body style="display:flex; justify-content: center;">
    <div class="main-container_nps_lite">
        <p class="time_nps_lite" id="countdown"></p>
        <p class="title_nps_lite"></p>
        <div class="container_nps_lite">
            <div onclick="submitCategory('distractor')" class="left_nps_lite"></div>
            <div onclick="submitCategory('promoter')" class="center_nps_lite"></div>
            <div onclick="submitCategory('passive')" class="right_nps_lite"></div>
        </div>
    </div>
{% for default in defaults %}
<script>
    if('{{default.orientation|safe}}' === "vertical"){
        document.querySelector(".container_nps_lite").style.flexDirection = "column"
        document.querySelector(".container_nps_lite").style.justifyContent = "space-between"
    }

    document.querySelector(".left_nps_lite").innerHTML = `üôÅ {{default.left|safe}}`
    document.querySelector(".center_nps_lite").innerHTML = `üôÇ {{default.center|safe}}`
    document.querySelector(".right_nps_lite").innerHTML = `üòÉ {{default.right|safe}}`
    document.querySelector(".title_nps_lite").innerHTML = "{{default.question|safe}}"


    document.querySelector(".left_nps_lite").style.background = "{{default.scalecolor|safe}}"
    document.querySelector(".center_nps_lite").style.background = "{{default.scalecolor|safe}}"
    document.querySelector(".right_nps_lite").style.background = "{{default.scalecolor|safe}}"

    document.querySelector(".left_nps_lite").style.color = "{{default.fontcolor|safe}}"
    document.querySelector(".center_nps_lite").style.color = "{{default.fontcolor|safe}}"
    document.querySelector(".right_nps_lite").style.color = "{{default.fontcolor|safe}}"

    function submitCategory(category){
        var score_tag = document.getElementById("scoretag")
        score_tag.value = category
        document.getElementById('jsform').submit();
        // if (score_tag.value !== ""){
        //     window.location.replace("http://100014.pythonanywhere.com/main")
        // }
    }
</script>
<script>
    let time = {{default.time|safe}};
    const countdownEl = document.getElementById("countdown");


    if (time === 0){
        countdownEl.style.display = "none"
    } else {
        setInterval(updateCountdown, 1000)
    }

    function updateCountdown(){
        const minutes = Math.floor(time/60);
        let seconds = time % 60;

        seconds = seconds < 10 ? '0' + seconds : seconds;

        countdownEl.innerHTML = `${minutes}:${seconds}`
        seconds < 10  && minutes == 0 ? countdownEl.style.color = "red" : countdownEl.style.color = "black" ;
        time--;
        time = time < 0 ? redirectMain() : time;
    }


    function redirectMain(){
        window.location.replace("http://100014.pythonanywhere.com/main")
    }
</script>
</body>
{% endfor %}
</html>